<!DOCTYPE HTML>
<html>
    <head title="language style">
        <link rel="Stylesheet" href="resource/langstyle.css" />
        <script type="text/javascript" src="resource/promise.js"></script>
        <script type="text/javascript" src="resource/ajax.js"></script>
        <script type="text/javascript" src="resource/simpleDom.js"></script>
        <script type="text/javascript" src="resource/langstyle.js"></script>
        <script type="text/javascript" src="resource/wordStage.js"></script>
        <script type="text/javascript" src="resource/wordCharacter.js"></script>
        <script type="text/javascript" src="resource/wordImage.js"></script>
        <script type="text/javascript" src="resource/wordSound.js"></script>
        <script type="text/javascript" src="resource/fileUploader.js"></script>
        <script type="text/javascript" src="resource/materialProvider.js"></script>
    </head>
    <body>
        <div class="b-start">
            <button id="start" class="js-start">Start</button>
            <button id="add" class="js-add">Add</button>
        </div>
        <div id="stage" class="js-wordStage b-stage hidden">
            <div class="js-wordStageTop">
                <input type="text" id="testCharacterCode" />
                <button type="button" id="testImages" onclick="javascript:showImages();">Show</button>
                <div id="images"></div>
                <div class="js-wordCharacter">
                    <label id="character"></label>
                </div>
                <div class="js-wordSound">
                    <audio id="sound"></audio>
                </div>
                <div class="js-needRemove">
                    <button type="button" class="js-next" onclick="wordStage.nextWord();">Next</button>
                </div>
            </div>
            <div class="">
                <img id="image" alt="word image" />
            </div>
        </div>
        <div id="addStage" class="js-add-page hidden">
                <form method="post" enctype="multipart/form-data" 
                action="javascript:materialProvider.linkImageToCharacter();">
                    <input type="file" id="imageFile" name="imageFile" />
                    <label id="fileSize"></label>
                    <br />
                    <label>Character</label>
                    <input type="text" id="characterCode"/>
                    <br />
                    <button type="submit" id="uploadImage">Submit</button>
                </form>
        </div>
        
        <script type="text/javascript" src="resource/index.js"></script>
        <script type="text/javascript">
            var materialProvider = new MeterialProvider("imageFile", "characterCode");
        </script>
        <script type="text/javascript">
            function showImages(){
                var characterCode = dom.getById("testCharacterCode").value;
                ajax.get(langstyle.characterCodeUrl + "/" + characterCode).then(function(characterId){
                        ajax.get(langstyle.characterImagesUrl + "/" + characterId).then(function(imageIds){
                            var imageIdArray = imageIds.split(",");
                            var imagesArea = dom.getById("images");
                            dom.emptyElement(imagesArea);
                            for(var i= imageIdArray.length-1;i>=0;i--){
                                var imageView = dom.createElement("image"); 
                                imageView.alt = imageIdArray[i];
                                imageView.src = langstyle.imageUrl + "/" + imageIdArray[i];
                                imagesArea.appendChild(imageView);
                            }
                            });
                });
            }
        </script>
    </body>
</html>
